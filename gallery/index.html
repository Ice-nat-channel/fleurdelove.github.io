<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Fleur de Love | Flower Shop</title>
  <link href="https://fonts.googleapis.com/css2?family=Mali:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../style.css">
  <link rel="icon" href="../icon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="../icon.ico">
</head>
<body>
  <a class="skip-link" href="#gallery">Skip to content</a>

<header>
  <h1>Fleur de Love</h1>
  <p>‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡πÅ‡∏ó‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å ‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÇ‡∏≠‡∏Å‡∏≤‡∏™</p>
</header>

<nav class="site-nav" aria-label="Main navigation">
  <div class="nav-inner">
    <button type="button" class="nav-toggle" aria-expanded="false" aria-controls="primary-navigation" aria-label="Open navigation">
      <span class="hamburger" aria-hidden="true"></span>
    </button>
    <div id="primary-navigation" class="nav-links" aria-hidden="true">
      <a href="../home/">Home</a>
      <a href="../price/">Price</a>
      <a href="../gallery/">Gallery</a>
      <a href="../contact/">Contact</a>
    </div>
  </div>
</nav>

<main class="page-content">

<section id="gallery" class="full-viewport">
  <div class="card">
    <h2>Gallery</h2>
    <p>‡∏£‡∏ß‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô üå∑ ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏î‡∏π</p>

    <div class="gallery-grid" aria-label="Gallery" id="galleryGrid">
      <!-- Gallery items will be loaded here from admin dashboard -->
    </div>
    <p id="noGalleryMsg" style="text-align: center; color: #999; margin-top: 20px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡πÅ‡∏Å‡∏•‡πÄ‡∏•‡∏≠‡∏£‡∏µ‡πà ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà Admin Dashboard ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</p>
  </div>
</section>

</main>

<!-- Lightbox / modal -->
<div id="lightbox" class="lightbox" aria-hidden="true" role="dialog" aria-label="Image viewer">
  <button class="lightbox__close" aria-label="‡∏õ‡∏¥‡∏î">√ó</button>
  <button class="lightbox__nav lightbox__prev" aria-label="‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤">‚Äπ</button>
  <div class="lightbox__content">
    <img src="" alt="">
  </div>
  <button class="lightbox__nav lightbox__next" aria-label="‡∏ñ‡∏±‡∏î‡πÑ‡∏õ">‚Ä∫</button>
</div>

<script>
  // Load gallery images from admin dashboard
  function loadGalleryImages() {
    const gallery = JSON.parse(localStorage.getItem('gallery')) || [];
    const galleryGrid = document.getElementById('galleryGrid');
    const noGalleryMsg = document.getElementById('noGalleryMsg');
    
    if (gallery.length === 0) {
      noGalleryMsg.style.display = 'block';
      return;
    }
    
    noGalleryMsg.style.display = 'none';
    galleryGrid.innerHTML = '';
    
    gallery.forEach((image, index) => {
      const btn = document.createElement('button');
      btn.className = 'gallery-item';
      btn.setAttribute('data-index', index);
      btn.setAttribute('data-src', image.url);
      btn.setAttribute('aria-label', `‡πÄ‡∏õ‡∏¥‡∏î‡∏†‡∏≤‡∏û ${index + 1}`);
      
      const img = document.createElement('img');
      img.src = image.url;
      img.alt = image.alt || image.title;
      
      btn.appendChild(img);
      galleryGrid.appendChild(btn);
    });
    
    // Re-initialize lightbox with new items
    initLightbox();
  }

  function initLightbox() {
    const items = Array.from(document.querySelectorAll('.gallery-item'));
    if (items.length === 0) return;
    
    const lightbox = document.getElementById('lightbox');
    const lbImage = lightbox.querySelector('.lightbox__content img');
    const btnClose = lightbox.querySelector('.lightbox__close');
    const btnPrev = lightbox.querySelector('.lightbox__prev');
    const btnNext = lightbox.querySelector('.lightbox__next');
    let current = 0;
    let isAnimating = false;

    function open(index) {
      if (isAnimating) return;
      const item = items[index];
      if (!item) return;
      current = index;
      lbImage.src = item.dataset.src;
      lbImage.alt = item.querySelector('img').alt || '';
      lightbox.classList.remove('is-closing');
      lightbox.setAttribute('aria-hidden', 'false');
      void lbImage.offsetWidth;
      btnClose.focus();
      isAnimating = false;
    }

    function close() {
      if (isAnimating) return;
      isAnimating = true;
      lightbox.classList.add('is-closing');
      const closeDuration = 260;
      setTimeout(() => {
        lightbox.setAttribute('aria-hidden', 'true');
        lightbox.classList.remove('is-closing');
        lbImage.src = '';
        isAnimating = false;
      }, closeDuration);
    }

    function showNext(dir = 1) {
      current = (current + dir + items.length) % items.length;
      open(current);
    }

    items.forEach((btn, i) => btn.addEventListener('click', () => open(i)));
    btnClose.addEventListener('click', close);
    btnPrev.addEventListener('click', () => showNext(-1));
    btnNext.addEventListener('click', () => showNext(1));

    lightbox.addEventListener('click', (e) => {
      if (e.target === lightbox) close();
    });

    document.addEventListener('keydown', (e) => {
      if (lightbox.getAttribute('aria-hidden') === 'true') return;
      if (e.key === 'Escape') close();
      if (e.key === 'ArrowRight') showNext(1);
      if (e.key === 'ArrowLeft') showNext(-1);
    });
  }

  // Load on page load
  window.addEventListener('DOMContentLoaded', function() {
    loadGalleryImages();
  });
</script>

<script>
  (function() {
    const items = Array.from(document.querySelectorAll('.gallery-item'));
    const lightbox = document.getElementById('lightbox');
    const lbImage = lightbox.querySelector('.lightbox__content img');
    const btnClose = lightbox.querySelector('.lightbox__close');
    const btnPrev = lightbox.querySelector('.lightbox__prev');
    const btnNext = lightbox.querySelector('.lightbox__next');
    let current = 0;
    let isAnimating = false;

    function open(index) {
      if (isAnimating) return;
      const item = items[index];
      if (!item) return;
      current = index;
      lbImage.src = item.dataset.src;
      lbImage.alt = item.querySelector('img').alt || '';
      // ensure any previous closing state is cleared
      lightbox.classList.remove('is-closing');
      lightbox.setAttribute('aria-hidden', 'false');
      // force reflow so animation restarts reliably
      void lbImage.offsetWidth;
      btnClose.focus();
    }

    function close() {
      if (isAnimating) return;
      isAnimating = true;
      // add closing flag so CSS runs close animation
      lightbox.classList.add('is-closing');
      // wait for animation to finish before hiding and clearing src
      const closeDuration = 260; // match CSS timing
      setTimeout(() => {
        lightbox.setAttribute('aria-hidden', 'true');
        lightbox.classList.remove('is-closing');
        lbImage.src = '';
        isAnimating = false;
      }, closeDuration);
    }

    function showNext(dir = 1) {
      current = (current + dir + items.length) % items.length;
      open(current);
    }

    items.forEach((btn, i) => btn.addEventListener('click', () => open(i)));
    btnClose.addEventListener('click', close);
    btnPrev.addEventListener('click', () => showNext(-1));
    btnNext.addEventListener('click', () => showNext(1));

    lightbox.addEventListener('click', (e) => {
      if (e.target === lightbox) close();
    });

    document.addEventListener('keydown', (e) => {
      if (lightbox.getAttribute('aria-hidden') === 'true') return;
      if (e.key === 'Escape') close();
      if (e.key === 'ArrowRight') showNext(1);
      if (e.key === 'ArrowLeft') showNext(-1);
    });
  })();
</script>

<footer>
  ¬© 2026 Fleur de Love | By N.Parin | <a href="/admin/login.html" style="color: inherit; text-decoration: none; opacity: 0.7; transition: opacity 0.3s;" onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'">Admin</a>
</footer>

<script>
  window.addEventListener('DOMContentLoaded', function() {
    document.documentElement.classList.add('is-loaded');
  });
</script>

<script>
  (function(){
    const btn = document.querySelector('.nav-toggle');
    const nav = document.querySelector('.site-nav .nav-links');
    if (!btn || !nav) return;
      function openNav(){ console.log('[nav] openNav called'); nav.classList.add('visible'); nav.setAttribute('aria-hidden','false'); btn.setAttribute('aria-expanded','true'); document.documentElement.classList.add('menu-open'); btn.classList.add('toggled'); const first = nav.querySelector('a'); if (first && window.matchMedia && window.matchMedia('(hover: hover)').matches) first.focus(); console.log('[nav] visible after open', nav.classList.contains('visible')); }
    function closeNav(){ console.log('[nav] closeNav called'); nav.classList.remove('visible'); nav.setAttribute('aria-hidden','true'); btn.setAttribute('aria-expanded','false'); document.documentElement.classList.remove('menu-open'); btn.classList.remove('toggled'); btn.focus(); console.log('[nav] visible after close', nav.classList.contains('visible')); }
    btn.addEventListener('click', function(e){ console.log('[nav] toggle click', e.target); e.preventDefault(); e.stopPropagation(); e.stopImmediatePropagation(); btn.classList.add('clicked'); setTimeout(() => btn.classList.remove('clicked'), 360); if (nav.classList.contains('visible')) { closeNav(); } else { openNav(); } }, true);
    document.addEventListener('click', function(e){ console.log('[nav] document click', e.target); if (!nav.contains(e.target) && !btn.contains(e.target)) closeNav(); });
    document.addEventListener('keydown', function(e){ if (e.key === 'Escape') closeNav(); });
    function checkWidth(){ if (window.matchMedia('(min-width:700px)').matches){ nav.classList.remove('visible'); nav.setAttribute('aria-hidden','false'); btn.setAttribute('aria-expanded','false'); document.documentElement.classList.remove('menu-open'); } else { nav.setAttribute('aria-hidden','true'); } }
    window.addEventListener('resize', checkWidth);
    checkWidth();
  })();
</script>
<!-- Click sound: plays a short click on interactive elements -->
<script>
  (function(){
    if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
    const src = '/assets/click.mp3';
    const poolSize = 6;
    const pool = [];
    for (let i=0;i<poolSize;i++){ const a = new Audio(src); a.preload='auto'; a.volume=0.45; pool.push(a); }
    let idx = 0;
    function play(){ try{ const a = pool[idx]; a.currentTime = 0; a.play(); idx = (idx+1)%poolSize; }catch(e){console.warn('click audio failed', e)} }
    const selector = 'a, button, .btn, [role="button"], input[type="button"], input[type="submit"], .gallery-item';

    document.addEventListener('click', function(e){
      if (e.button !== 0) return;
      if (e.defaultPrevented) return;
      if (e.metaKey || e.ctrlKey || e.shiftKey || e.altKey) return;
      const el = e.target.closest(selector);
      if (!el) return;
      if (el.classList && el.classList.contains('nav-toggle')) return; 

      if (el.tagName === 'A' && el.href) {
        try {
          const url = new URL(el.href, location.href);
          const isSameOrigin = url.origin === location.origin;
          const isHashOnly = url.pathname === location.pathname && url.hash;
          const isExternal = el.target === '_blank' || el.hasAttribute('download');
          if (isSameOrigin && !isHashOnly && !isExternal) {
            e.preventDefault();
            play();
            setTimeout(() => { location.href = url.href; }, 160);
            return;
          }
        } catch(e) {}
      }

      play();
    }, true);

    document.addEventListener('keydown', function(e){
      if (e.defaultPrevented) return;
      if (e.key !== 'Enter' && e.key !== ' ') return;
      const el = document.activeElement;
      if (!el || !el.matches(selector)) return;

      if (el.tagName === 'A' && el.href) {
        try {
          const url = new URL(el.href, location.href);
          const isSameOrigin = url.origin === location.origin;
          const isHashOnly = url.pathname === location.pathname && url.hash;
          const isExternal = el.target === '_blank' || el.hasAttribute('download');
          if (isSameOrigin && !isHashOnly && !isExternal) {
            e.preventDefault();
            play();
            setTimeout(() => { location.href = url.href; }, 160);
            return;
          }
        } catch(e) {}
      }

      play();
    }, true);

  })();
</script>

</body>
</html>
